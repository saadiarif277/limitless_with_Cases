import{L as N}from"./index-CU3kptrY.js";import{T as F,r as d,o as s,c as a,a as n,g as k,w as o,F as c,b as l,t as u,d as E,f as _,e as f,i as q}from"./app-D0YmfmiQ.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_user-menu-Bj-M8e4u.js";const D={name:"RolesCreateEdit",layout:N,props:{documentCategories:{type:Object,required:!1,defualt:()=>{}},permissions:{type:Object,required:!1,defualt:()=>{}},role:{type:Object,required:!1,default:()=>{}}},data(){return{form:F({name:"",document_category_ids:[],permission_ids:[]})}},watch:{role:{handler(i){!i||!i.data||(this.form.name=i.data.name,this.form.permission_ids=i.data.permissions.map(r=>r.id),this.form.document_category_ids=JSON.parse(JSON.stringify(i.data.document_categories)).map(r=>r.document_category_id).filter(r=>r!=null),console.log())},immediate:!0}},methods:{submitForm(){this.form.clearErrors(),this.role&&this.role.data&&this.role.data.id?this.updateRequest():this.storeRequest()},storeRequest(){this.form.post(this.route("panel.admin.roles.store"),{onSuccess:()=>this.$toast().success("Role created successfully!"),onError:i=>{Object.keys(i).forEach(r=>{const t=i[r];this.$toast().error(t)})}})},updateRequest(){this.form.patch(this.route("panel.admin.roles.update",{role:this.role.data.id}),{onSuccess:()=>this.$toast().success("Role updated successfully!"),onError:i=>{Object.keys(i).forEach(r=>{const t=i[r];this.$toast().error(t)})}})},deleteRequest(){this.$alert().confirm(()=>new Promise((i,r)=>{this.form.delete(this.route("panel.admin.roles.destroy",{role:this.role.data.id}),{onSuccess:()=>{this.$toast().success("Role deleted successfully!"),i()},onError:t=>{Object.keys(t).forEach(x=>{const e=t[x];this.$toast().error(e)}),r()}})}))}}},L={class:"h-full flex flex-col"},U={key:0,class:"flex gap-2"},J={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6"},P={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6"},T=["value"];function M(i,r,t,x,e,C){const S=d("v-inertia-head"),p=d("v-button"),w=d("v-section-heading"),R=d("v-content-body"),h=d("v-form-label"),O=d("v-form-input"),y=d("v-form-error"),g=d("v-form-group"),V=d("v-form-checkbox"),j=d("v-form");return s(),a(c,null,[n(S,{title:t.role?`Editing '${t.role.data.name}' role.`:"Create Role"},null,8,["title"]),k("div",L,[n(R,{class:"border-b border-gray-200"},{default:o(()=>[n(w,null,{title:o(()=>[t.role?(s(),a(c,{key:1},[l(" Editing '"+u(t.role.data.name)+"' role. ",1)],64)):(s(),a(c,{key:0},[l(" Create Role ")],64))]),description:o(()=>[t.role?(s(),a(c,{key:1},[l(" Change and/or modify the details for the role. ")],64)):(s(),a(c,{key:0},[l(" Fill up the form below to create a new role for the application. ")],64))]),actions:o(()=>[t.role?(s(),a("div",U,[n(p,{color:"danger",disabled:e.form.processing,onClick:E(C.deleteRequest,["stop"])},{default:o(()=>[l(" Delete Role ")]),_:1},8,["disabled","onClick"])])):_("",!0)]),_:1})]),_:1}),n(R,null,{default:o(()=>[n(j,{class:"space-y-6",onSubmit:E(C.submitForm,["prevent"])},{default:o(()=>[n(g,null,{default:o(()=>[n(h,null,{default:o(()=>[l("Name")]),_:1}),n(O,{type:"text",modelValue:e.form.name,"onUpdate:modelValue":r[0]||(r[0]=m=>e.form.name=m),error:e.form.errors.name,disabled:e.form.processing||t.role},null,8,["modelValue","error","disabled"]),e.form.errors.name?(s(),f(y,{key:0},{default:o(()=>[l(u(e.form.errors.name),1)]),_:1})):_("",!0)]),_:1}),n(g,null,{default:o(()=>[n(h,null,{default:o(()=>[l("Document Categories")]),_:1}),k("div",J,[(s(!0),a(c,null,q(t.documentCategories.data,(m,b)=>(s(),f(V,{key:"documentCategory_"+b,modelValue:e.form.document_category_ids,"onUpdate:modelValue":r[1]||(r[1]=v=>e.form.document_category_ids=v),value:m.document_category_id,disabled:e.form.processing},{default:o(()=>[l(u(m.name),1)]),_:2},1032,["modelValue","value","disabled"]))),128))]),e.form.errors.document_category_ids?(s(),f(y,{key:0},{default:o(()=>[l(u(e.form.errors.document_category_ids),1)]),_:1})):_("",!0)]),_:1}),n(g,null,{default:o(()=>[n(h,null,{default:o(()=>[l("Permissions")]),_:1}),k("div",P,[(s(!0),a(c,null,q(t.permissions.data,(m,b)=>(s(),f(V,{key:"permission_"+b,modelValue:e.form.permission_ids,"onUpdate:modelValue":r[2]||(r[2]=v=>e.form.permission_ids=v),value:m.id,disabled:e.form.processing},{default:o(()=>[l(u(m.name),1)]),_:2},1032,["modelValue","value","disabled"]))),128))]),e.form.errors.permission_ids?(s(),f(y,{key:0},{default:o(()=>[l(u(e.form.errors.permission_ids),1)]),_:1})):_("",!0)]),_:1}),n(g,{class:"flex items-center justify-end gap-2 text-right border-t border-gray-200 py-6"},{default:o(()=>[e.form.progress?(s(),a("progress",{key:0,value:e.form.progress.percentage,max:"100"},u(e.form.progress.percentage)+"% ",9,T)):_("",!0),n(p,{href:i.route("panel.admin.roles.index"),color:"white",disabled:e.form.processing},{default:o(()=>[l(" Cancel ")]),_:1},8,["href","disabled"]),t.role?(s(),f(p,{key:2,disabled:e.form.processing},{default:o(()=>[l(" Save Changes ")]),_:1},8,["disabled"])):(s(),f(p,{key:1,disabled:e.form.processing},{default:o(()=>[l(" Create Role ")]),_:1},8,["disabled"]))]),_:1})]),_:1},8,["onSubmit"])]),_:1})])],64)}const I=B(D,[["render",M]]);export{I as default};

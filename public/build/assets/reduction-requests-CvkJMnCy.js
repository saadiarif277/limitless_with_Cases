import{L as B}from"./index-DCEuP7LO.js";import{r as I,o as n,c as r,g as e,f as a,a as M,w as E,t as l,F,i as P,d as U,l as _,q as f,b as T,n as h,A as N,p as q,k as z}from"./app-D0YmfmiQ.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_user-menu-Bj-M8e4u.js";const O={name:"ReductionRequests",layout:B,props:{reductionRequests:{type:Array,required:!0,default:()=>[]},userRole:{type:String,required:!0}},data(){return{showCreateModal:!1,newRequest:{case_id:"",referral_id:"",amount:"",file:null,notes:""},creating:!1}},methods:{formatDate(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"},async submitDecision(s){if(!s.decision){this.$toast().error("Please select a decision");return}s.processing=!0;try{if((await this.$inertia.put(route("panel.user.referrals.update-reduction-decision",s.id),{doctor_decision:s.decision,counter_offer:s.counter_offer||null,notes:s.notes||null})).status===200){this.$toast().success("Decision submitted successfully");const c=this.reductionRequests.findIndex(g=>g.id===s.id);c>-1&&this.reductionRequests.splice(c,1)}}catch(i){this.$toast().error("Error submitting decision. Please try again."),console.error("Error:",i)}finally{s.processing=!1}},resetForm(s){s.decision=null,s.counter_offer=null,s.notes=""},async createReductionRequest(){if(!this.newRequest.case_id||!this.newRequest.referral_id||!this.newRequest.amount){this.$toast().error("Please fill in all required fields.");return}this.creating=!0;try{const s=new FormData;s.append("case_id",this.newRequest.case_id),s.append("referral_id",this.newRequest.referral_id),s.append("amount",this.newRequest.amount),this.newRequest.file&&s.append("file",this.newRequest.file),s.append("notes",this.newRequest.notes),(await this.$inertia.post(route("panel.user.referrals.store-reduction-request"),s)).status===201&&(this.$toast().success("Reduction request created successfully!"),this.showCreateModal=!1,this.newRequest={case_id:"",referral_id:"",amount:"",file:null,notes:""},this.$emit("reduction-request-created"))}catch(s){this.$toast().error("Error creating reduction request. Please try again."),console.error("Error:",s)}finally{this.creating=!1}},handleFileChange(s){this.newRequest.file=s.target.files[0]},getStatusBadgeClass(s){switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"accepted":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},getStatusText(s){switch(s){case"pending":return"Pending Response";case"accepted":return"Accepted";case"rejected":return"Rejected";default:return"Unknown Status"}},getDoctorDecisionBadgeClass(s){switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"accepted":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},getDoctorDecisionText(s){switch(s){case"pending":return"Pending";case"accepted":return"Accepted";case"rejected":return"Rejected";default:return"Unknown Decision"}}},mounted(){this.reductionRequests.forEach(s=>{s.decision=null,s.counter_offer=null,s.notes="",s.processing=!1})}},o=s=>(q("data-v-af90ecb3"),s=s(),z(),s),H={class:"h-full space-y-6"},Y={class:"bg-white shadow-sm rounded-lg p-6"},G={class:"flex items-center justify-between"},J=o(()=>e("h1",{class:"text-2xl font-semibold text-gray-900"},"Reduction Requests",-1)),K={class:"mt-1 text-sm text-gray-600"},Q={key:0},W={key:1},X={key:0},Z=o(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1)),$={class:"bg-white shadow-sm rounded-lg p-6"},ee={key:0,class:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded relative",role:"alert"},te={class:"block sm:inline"},se={key:1,class:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert"},oe={class:"block sm:inline"},ne={key:2,class:"text-center py-12"},re=o(()=>e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),ie=o(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No reduction requests",-1)),de={class:"mt-1 text-sm text-gray-500"},ae={key:0},le={key:1},ce={key:3,class:"space-y-6"},ue={class:"px-6 py-4"},me={class:"flex items-center justify-between mb-4"},_e={class:"text-lg font-medium text-gray-900"},fe={class:"text-sm text-gray-500"},he={class:"flex gap-2"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},pe=o(()=>e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Case Information",-1)),be={class:"space-y-2 text-sm text-gray-600"},ye=o(()=>e("span",{class:"font-medium"},"Case ID:",-1)),xe={class:"ml-2"},we=o(()=>e("span",{class:"font-medium"},"Patient:",-1)),ve={class:"ml-2"},Re={key:0},ke=o(()=>e("span",{class:"font-medium"},"Attorney:",-1)),De={class:"ml-2"},Ce={key:1},Ae=o(()=>e("span",{class:"font-medium"},"Doctor:",-1)),Ve={class:"ml-2"},Se=o(()=>e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Reduction Details",-1)),Ue={class:"space-y-2 text-sm text-gray-600"},Ne=o(()=>e("span",{class:"font-medium"},"Requested Amount:",-1)),je={class:"ml-2 text-lg font-semibold text-red-600"},Be={key:0},Ie=o(()=>e("span",{class:"font-medium"},"Counter Offer:",-1)),Me={class:"ml-2 text-lg font-semibold text-blue-600"},Ee={key:1},Fe=o(()=>e("span",{class:"font-medium"},"Notes:",-1)),Pe={class:"ml-2"},Te={key:0,class:"mb-6"},qe=o(()=>e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Supporting Documents",-1)),ze={class:"flex items-center space-x-2"},Le=o(()=>e("svg",{class:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})],-1)),Oe=["href"],He={key:1,class:"border-t border-gray-200 pt-6"},Ye=o(()=>e("h4",{class:"text-sm font-medium text-gray-700 mb-4"},"Your Response",-1)),Ge=["onSubmit"],Je=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Decision * ",-1)),Ke={class:"space-y-2"},Qe={class:"flex items-center"},We=["onUpdate:modelValue"],Xe=o(()=>e("span",{class:"ml-2 text-sm text-gray-700"},"Accept Reduction",-1)),Ze={class:"flex items-center"},$e=["onUpdate:modelValue"],et=o(()=>e("span",{class:"ml-2 text-sm text-gray-700"},"Reject Reduction",-1)),tt={key:0},st=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Counter Offer (Optional) ",-1)),ot={class:"relative"},nt=o(()=>e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("span",{class:"text-gray-500 sm:text-sm"},"$")],-1)),rt=["onUpdate:modelValue"],it=o(()=>e("p",{class:"mt-1 text-xs text-gray-500"}," Suggest a different amount if you'd like to negotiate ",-1)),dt=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notes (Optional) ",-1)),at=["onUpdate:modelValue"],lt={class:"flex justify-end space-x-3"},ct=["onClick"],ut=["disabled"],mt={key:0},_t={key:1},ft={key:2,class:"border-t border-gray-200 pt-6"},ht=o(()=>e("h4",{class:"text-sm font-medium text-gray-700 mb-4"},"Doctor's Response",-1)),gt={class:"bg-gray-50 rounded-lg p-4"},pt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},bt=o(()=>e("span",{class:"font-medium"},"Decision:",-1)),yt={key:0},xt=o(()=>e("span",{class:"font-medium"},"Counter Offer:",-1)),wt={class:"ml-2 text-lg font-semibold text-blue-600"},vt={key:1,class:"md:col-span-2"},Rt=o(()=>e("span",{class:"font-medium"},"Notes:",-1)),kt={class:"ml-2"},Dt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ct={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},At={class:"mt-3"},Vt=o(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Create New Reduction Request",-1)),St=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Case ID * ",-1)),Ut=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Referral ID * ",-1)),Nt=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Reduction Amount * ",-1)),jt={class:"relative"},Bt=o(()=>e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("span",{class:"text-gray-500 sm:text-sm"},"$")],-1)),It=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Supporting Document ",-1)),Mt=o(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notes ",-1)),Et={class:"flex justify-end space-x-3 pt-4"},Ft=["disabled"],Pt={key:0},Tt={key:1};function qt(s,i,c,g,d,u){var p,b,y,x,w,v;const j=I("v-button");return n(),r("div",H,[e("div",Y,[e("div",G,[e("div",null,[J,e("p",K,[c.userRole==="Doctor"?(n(),r("span",Q,"Review and respond to reduction requests from attorneys")):c.userRole==="Attorney"?(n(),r("span",W,"Track your reduction requests and their status")):a("",!0)])]),c.userRole==="Attorney"?(n(),r("div",X,[M(j,{onClick:i[0]||(i[0]=t=>d.showCreateModal=!0),color:"blue",class:"flex items-center gap-2"},{default:E(()=>[Z,T(" New Reduction Request ")]),_:1})])):a("",!0)])]),e("div",$,[(y=(b=(p=s.$page)==null?void 0:p.props)==null?void 0:b.flash)!=null&&y.success?(n(),r("div",ee,[e("span",te,l(s.$page.props.flash.success),1)])):a("",!0),(v=(w=(x=s.$page)==null?void 0:x.props)==null?void 0:w.flash)!=null&&v.error?(n(),r("div",se,[e("span",oe,l(s.$page.props.flash.error),1)])):a("",!0),c.reductionRequests.length===0?(n(),r("div",ne,[re,ie,e("p",de,[c.userRole==="Doctor"?(n(),r("span",ae,"You don't have any reduction requests at the moment.")):c.userRole==="Attorney"?(n(),r("span",le,"You haven't created any reduction requests yet.")):a("",!0)])])):(n(),r("div",ce,[(n(!0),r(F,null,P(c.reductionRequests,t=>{var R,k,D,C,A,V,S;return n(),r("div",{key:t.id,class:"bg-white shadow rounded-lg border border-gray-200"},[e("div",ue,[e("div",me,[e("div",null,[e("h3",_e," Reduction Request #"+l(t.id),1),e("p",fe," Requested on "+l(u.formatDate(t.created_at)),1)]),e("div",he,[e("span",{class:h(u.getStatusBadgeClass(t.referral_status))},l(u.getStatusText(t.referral_status)),3),e("span",{class:h(u.getDoctorDecisionBadgeClass(t.doctor_decision))},l(u.getDoctorDecisionText(t.doctor_decision)),3)])]),e("div",ge,[e("div",null,[pe,e("div",be,[e("div",null,[ye,e("span",xe,l(((R=t.case)==null?void 0:R.case_id)||"N/A"),1)]),e("div",null,[we,e("span",ve,l(((D=(k=t.referral)==null?void 0:k.patientUser)==null?void 0:D.name)||"N/A"),1)]),c.userRole==="Doctor"?(n(),r("div",Re,[ke,e("span",De,l(((A=(C=t.referral)==null?void 0:C.attorneyUser)==null?void 0:A.name)||"N/A"),1)])):a("",!0),c.userRole==="Attorney"?(n(),r("div",Ce,[Ae,e("span",Ve,l(((S=(V=t.referral)==null?void 0:V.doctorUser)==null?void 0:S.name)||"N/A"),1)])):a("",!0)])]),e("div",null,[Se,e("div",Ue,[e("div",null,[Ne,e("span",je,"$"+l(t.amount),1)]),t.counter_offer?(n(),r("div",Be,[Ie,e("span",Me,"$"+l(t.counter_offer),1)])):a("",!0),t.notes?(n(),r("div",Ee,[Fe,e("span",Pe,l(t.notes),1)])):a("",!0)])])]),t.file_path?(n(),r("div",Te,[qe,e("div",ze,[Le,e("a",{href:`/storage/${t.file_path}`,target:"_blank",class:"text-blue-600 hover:text-blue-800 text-sm"}," View Document ",8,Oe)])])):a("",!0),c.userRole==="Doctor"&&t.doctor_decision==="pending"?(n(),r("div",He,[Ye,e("form",{onSubmit:U(m=>u.submitDecision(t),["prevent"]),class:"space-y-4"},[e("div",null,[Je,e("div",Ke,[e("label",Qe,[_(e("input",{type:"radio","onUpdate:modelValue":m=>t.decision=m,value:"accepted",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,8,We),[[N,t.decision]]),Xe]),e("label",Ze,[_(e("input",{type:"radio","onUpdate:modelValue":m=>t.decision=m,value:"rejected",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,8,$e),[[N,t.decision]]),et])])]),t.decision==="rejected"?(n(),r("div",tt,[st,e("div",ot,[nt,_(e("input",{type:"number","onUpdate:modelValue":m=>t.counter_offer=m,step:"0.01",min:"0",class:"pl-7 block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"0.00"},null,8,rt),[[f,t.counter_offer]])]),it])):a("",!0),e("div",null,[dt,_(e("textarea",{"onUpdate:modelValue":m=>t.notes=m,rows:"3",class:"block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Add any additional notes or comments..."},null,8,at),[[f,t.notes]])]),e("div",lt,[e("button",{type:"button",onClick:m=>u.resetForm(t),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Reset ",8,ct),e("button",{type:"submit",disabled:!t.decision||t.processing,class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[t.processing?(n(),r("span",mt,"Processing...")):(n(),r("span",_t,"Submit Decision"))],8,ut)])],40,Ge)])):a("",!0),c.userRole==="Attorney"&&t.doctor_decision!=="pending"?(n(),r("div",ft,[ht,e("div",gt,[e("div",pt,[e("div",null,[bt,e("span",{class:h([u.getDoctorDecisionBadgeClass(t.doctor_decision),"ml-2"])},l(u.getDoctorDecisionText(t.doctor_decision)),3)]),t.counter_offer?(n(),r("div",yt,[xt,e("span",wt,"$"+l(t.counter_offer),1)])):a("",!0),t.notes?(n(),r("div",vt,[Rt,e("span",kt,l(t.notes),1)])):a("",!0)])])])):a("",!0)])])}),128))]))]),d.showCreateModal?(n(),r("div",Dt,[e("div",Ct,[e("div",At,[Vt,e("form",{onSubmit:i[7]||(i[7]=U((...t)=>u.createReductionRequest&&u.createReductionRequest(...t),["prevent"])),class:"space-y-4"},[e("div",null,[St,_(e("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=t=>d.newRequest.case_id=t),class:"block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter case ID",required:""},null,512),[[f,d.newRequest.case_id]])]),e("div",null,[Ut,_(e("input",{type:"text","onUpdate:modelValue":i[2]||(i[2]=t=>d.newRequest.referral_id=t),class:"block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter referral ID",required:""},null,512),[[f,d.newRequest.referral_id]])]),e("div",null,[Nt,e("div",jt,[Bt,_(e("input",{type:"number","onUpdate:modelValue":i[3]||(i[3]=t=>d.newRequest.amount=t),step:"0.01",min:"0",class:"pl-7 block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"0.00",required:""},null,512),[[f,d.newRequest.amount]])])]),e("div",null,[It,e("input",{type:"file",onChange:i[4]||(i[4]=(...t)=>u.handleFileChange&&u.handleFileChange(...t)),accept:".pdf,.doc,.docx",class:"block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,32)]),e("div",null,[Mt,_(e("textarea",{"onUpdate:modelValue":i[5]||(i[5]=t=>d.newRequest.notes=t),rows:"3",class:"block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Add any notes or comments..."},null,512),[[f,d.newRequest.notes]])]),e("div",Et,[e("button",{type:"button",onClick:i[6]||(i[6]=t=>d.showCreateModal=!1),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Cancel "),e("button",{type:"submit",disabled:!d.newRequest.case_id||!d.newRequest.referral_id||!d.newRequest.amount||d.creating,class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[d.creating?(n(),r("span",Pt,"Creating...")):(n(),r("span",Tt,"Create Request"))],8,Ft)])],32)])])])):a("",!0)])}const Yt=L(O,[["render",qt],["__scopeId","data-v-af90ecb3"]]);export{Yt as default};

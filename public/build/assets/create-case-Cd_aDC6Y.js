import{L as B}from"./index-Du1Ufjen.js";import{T as F,r as p,o as a,e as y,w as t,g as n,c as g,t as c,f as d,a as r,b as i,F as R,i as L,d as A}from"./app-Bi_K_mTy.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_user-menu-BSju8n0v.js";const J={name:"CaseCreateForm",props:{attorneys:{type:Object,required:!0},doctors:{type:Object,required:!0},patients:{type:Object,required:!0},states:{type:Object,required:!0},allCptCodes:{type:Object,required:!0},referrals:{type:Object,required:!0},userRole:{type:String,required:!0},userId:{type:Number,required:!0},listRoute:{type:String,default:"panel.user.cases.index"},storeRoute:{type:String,default:"panel.user.cases.store"}},data(){return{form:F({state_id:0,patient_id:null,attorney_id:this.userRole==="Doctor"?null:this.userId||0,piloting_physician_id:this.userRole==="Attorney"?null:this.userId||0,policy_limit_info:JSON.stringify({policy_limit:"",pip_coverage:"",commercial_case:!1}),type_of_accident:"",billing_type:this.userRole==="Doctor"?"Insurance":null,service_billed:this.userRole==="Doctor"?"":null,cpt_codes:[],referral_ids:[],primary_referral_id:null,case_won:!1,outcome:"",reduction_accepted:!1,is_closed:!1,closed_at:null,policy_limit:this.userRole==="Attorney"?"":null,pip_coverage:this.userRole==="Attorney"?"":null,commercial_case:this.userRole==="Attorney"?!1:null}),selectedCptCodes:[],selectedReferrals:[]}},computed:{stateOptions(){return(this.states.data||[]).map(o=>({label:o.name,value:o.id}))},patientOptions(){return(this.patients.data||[]).map(o=>({label:o.name,value:o.user_id}))},attorneyOptions(){return(this.attorneys.data||[]).map(o=>({label:o.name,value:o.user_id}))},doctorOptions(){return(this.doctors.data||[]).map(o=>({label:o.name,value:o.user_id}))},cptCodeOptions(){var o;return(o=this.allCptCodes)!=null&&o.data?this.allCptCodes.data.map(l=>({label:`${l.code} - ${l.description}`,value:l.code,description:l.description,default_value:l.default_value})):[]},referralOptions(){return(this.referrals.data||[]).map(o=>{var l;return{label:`Referral #${o.id} - ${((l=o.patient_user)==null?void 0:l.name)||"Unknown Patient"}`,value:o.id}})}},methods:{addCptCode(){this.userRole==="Doctor"&&this.form.billing_type==="Insurance"&&this.form.cpt_codes.push({code:"",value:"",description:""})},removeCptCode(o){this.userRole==="Doctor"&&this.form.cpt_codes.splice(o,1)},updateCptCodes(){if(this.userRole==="Doctor"&&this.form.billing_type==="Insurance"){const o=this.form.cpt_codes.filter(l=>l.code&&l.value);this.form.cpt_codes=o}},submitForm(){if(this.selectedReferrals&&this.selectedReferrals.length>0&&(this.form.primary_referral_id=this.selectedReferrals[0],this.form.referral_ids=this.selectedReferrals),this.userRole==="Attorney"&&(this.form.policy_limit_info=JSON.stringify({policy_limit:this.form.policy_limit,pip_coverage:this.form.pip_coverage,commercial_case:this.form.commercial_case})),this.userRole==="Doctor")if(this.form.billing_type==="Insurance"){const o=this.form.cpt_codes.filter(l=>l.code&&l.value);this.form.cpt_codes=o}else this.form.cpt_codes=null;this.userRole==="Doctor"?(delete this.form.policy_limit,delete this.form.pip_coverage,delete this.form.commercial_case):this.userRole==="Attorney"&&(delete this.form.billing_type,delete this.form.service_billed,delete this.form.cpt_codes),this.form.post(route(this.storeRoute),{preserveScroll:!0,onSuccess:()=>{}})}},watch:{selectedCptCodes:{deep:!0,handler(){this.userRole==="Doctor"&&this.form.billing_type==="Insurance"&&this.updateCptCodes()}},selectedReferrals:{handler(o){o&&o.length>0?(this.form.primary_referral_id=o[0],this.form.referral_ids=o):(this.form.primary_referral_id=null,this.form.referral_ids=[])}},"form.billing_type":{handler(o){o==="LOP"&&(this.form.cpt_codes=[])}}}},M={class:"h-full divide-y divide-gray-200 space-y-12"},E={key:0,class:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded relative",role:"alert"},W={class:"block sm:inline"},z={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert"},G={class:"block sm:inline"},H={key:2},K={class:"mt-6"},Q={key:0,class:"text-gray-500 mb-4"},X={class:"text-right mt-4"};function Y(o,l,_,D,e,u){const m=p("v-form-label"),h=p("v-form-select"),f=p("v-form-error"),b=p("v-form-group"),v=p("v-content-body"),C=p("v-form-input"),I=p("v-form-checkbox"),N=p("v-section-heading"),O=p("v-button"),T=p("v-form");return a(),y(T,{class:"h-full",onSubmit:A(u.submitForm,["prevent"])},{default:t(()=>{var q,w,x,S,P,U;return[n("div",M,[(x=(w=(q=o.$page)==null?void 0:q.props)==null?void 0:w.flash)!=null&&x.success?(a(),g("div",E,[n("span",W,c(o.$page.props.flash.success),1)])):d("",!0),(U=(P=(S=o.$page)==null?void 0:S.props)==null?void 0:P.flash)!=null&&U.error?(a(),g("div",z,[n("span",G,c(o.$page.props.flash.error),1)])):d("",!0),n("div",null,[r(v,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:t(()=>[r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Case State")]),_:1}),r(h,{options:_.states.data.map(s=>({label:s.name,value:s.state_id})),error:e.form.errors.state_id,disabled:e.form.processing,required:!0,modelValue:e.form.state_id,"onUpdate:modelValue":l[0]||(l[0]=s=>e.form.state_id=s)},null,8,["options","error","disabled","modelValue"]),e.form.errors.state_id?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.state_id),1)]),_:1})):d("",!0)]),_:1}),r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Patient")]),_:1}),r(h,{options:u.patientOptions,error:e.form.errors.patient_id,disabled:e.form.processing,required:!0,modelValue:e.form.patient_id,"onUpdate:modelValue":l[1]||(l[1]=s=>e.form.patient_id=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.patient_id?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.patient_id),1)]),_:1})):d("",!0)]),_:1}),r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Case Type")]),_:1}),r(h,{options:[{label:"Auto Accident",value:"auto_accident"},{label:"Slip and Fall",value:"slip_and_fall"},{label:"Workers Compensation",value:"workers_comp"},{label:"Personal Injury",value:"personal_injury"}],error:e.form.errors.type_of_accident,disabled:e.form.processing,required:!0,modelValue:e.form.type_of_accident,"onUpdate:modelValue":l[2]||(l[2]=s=>e.form.type_of_accident=s),class:"w-full"},null,8,["error","disabled","modelValue"]),e.form.errors.type_of_accident?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.type_of_accident),1)]),_:1})):d("",!0)]),_:1})]),_:1})]),n("div",null,[r(v,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:t(()=>[_.userRole==="Doctor"?(a(),g(R,{key:0},[r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Select Attorney")]),_:1}),r(h,{options:u.attorneyOptions,error:e.form.errors.attorney_id,disabled:e.form.processing,required:!0,modelValue:e.form.attorney_id,"onUpdate:modelValue":l[3]||(l[3]=s=>e.form.attorney_id=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.attorney_id?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.attorney_id),1)]),_:1})):d("",!0)]),_:1}),r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Billing Type")]),_:1}),r(h,{modelValue:e.form.billing_type,"onUpdate:modelValue":l[4]||(l[4]=s=>e.form.billing_type=s),options:[{label:"Insurance",value:"Insurance"},{label:"LOP",value:"LOP"}],error:e.form.errors.billing_type,disabled:e.form.processing,required:!0,class:"w-full"},null,8,["modelValue","error","disabled"]),e.form.errors.billing_type?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.billing_type),1)]),_:1})):d("",!0)]),_:1}),r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Service Billed")]),_:1}),r(C,{type:"number",modelValue:e.form.service_billed,"onUpdate:modelValue":l[5]||(l[5]=s=>e.form.service_billed=s),error:e.form.errors.service_billed,disabled:e.form.processing,required:!0,class:"w-full"},null,8,["modelValue","error","disabled"]),e.form.errors.service_billed?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.service_billed),1)]),_:1})):d("",!0)]),_:1})],64)):d("",!0),_.userRole==="Attorney"?(a(),g(R,{key:1},[r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Select Doctor")]),_:1}),r(h,{options:u.doctorOptions,error:e.form.errors.piloting_physician_id,disabled:e.form.processing,required:!0,modelValue:e.form.piloting_physician_id,"onUpdate:modelValue":l[6]||(l[6]=s=>e.form.piloting_physician_id=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.piloting_physician_id?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.piloting_physician_id),1)]),_:1})):d("",!0)]),_:1}),r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Policy Limit")]),_:1}),r(C,{type:"number",error:e.form.errors.policy_limit,disabled:e.form.processing,required:!0,modelValue:e.form.policy_limit,"onUpdate:modelValue":l[7]||(l[7]=s=>e.form.policy_limit=s),class:"w-full"},null,8,["error","disabled","modelValue"]),e.form.errors.policy_limit?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.policy_limit),1)]),_:1})):d("",!0)]),_:1}),r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("PIP Coverage")]),_:1}),r(C,{type:"number",error:e.form.errors.pip_coverage,disabled:e.form.processing,required:!0,modelValue:e.form.pip_coverage,"onUpdate:modelValue":l[8]||(l[8]=s=>e.form.pip_coverage=s),class:"w-full"},null,8,["error","disabled","modelValue"]),e.form.errors.pip_coverage?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.pip_coverage),1)]),_:1})):d("",!0)]),_:1}),r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Commercial Case")]),_:1}),r(I,{error:e.form.errors.commercial_case,disabled:e.form.processing,modelValue:e.form.commercial_case,"onUpdate:modelValue":l[9]||(l[9]=s=>e.form.commercial_case=s)},null,8,["error","disabled","modelValue"]),e.form.errors.commercial_case?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.commercial_case),1)]),_:1})):d("",!0)]),_:1})],64)):d("",!0)]),_:1})]),_.userRole==="Doctor"&&e.form.billing_type==="Insurance"?(a(),g("div",H,[r(v,null,{default:t(()=>[r(N,null,{title:t(()=>[i("CPT Codes")]),description:t(()=>[i("Add CPT codes for billing")]),_:1}),n("div",K,[e.form.cpt_codes.length===0?(a(),g("div",Q," No CPT codes added yet. ")):d("",!0),(a(!0),g(R,null,L(e.form.cpt_codes,(s,V)=>(a(),g("div",{key:V,class:"flex gap-4 mb-4"},[r(h,{options:u.cptCodeOptions,modelValue:s.code,"onUpdate:modelValue":k=>s.code=k,error:e.form.errors[`cpt_codes.${V}.code`],disabled:e.form.processing,class:"flex-1",placeholder:"Select CPT Code"},null,8,["options","modelValue","onUpdate:modelValue","error","disabled"]),r(C,{type:"number",modelValue:s.value,"onUpdate:modelValue":k=>s.value=k,error:e.form.errors[`cpt_codes.${V}.value`],disabled:e.form.processing,placeholder:"Value",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue","error","disabled"]),r(O,{type:"button",onClick:A(k=>u.removeCptCode(V),["prevent"]),color:"red",class:"self-end"},{default:t(()=>[i(" Remove ")]),_:2},1032,["onClick"])]))),128)),r(O,{type:"button",onClick:A(u.addCptCode,["prevent"]),color:"primary",class:"mt-4"},{default:t(()=>[i(" Add CPT Code ")]),_:1},8,["onClick"])])]),_:1})])):d("",!0),n("div",null,[r(v,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:t(()=>[r(b,null,{default:t(()=>[r(m,null,{default:t(()=>[i("Referrals")]),_:1}),r(h,{options:_.referrals.data.map(s=>({label:`Referral #${s.referral_id} - ${s.patient_user.name}`,value:s.referral_id})),error:e.form.errors.referral_ids,disabled:e.form.processing,multiple:!0,modelValue:e.form.referral_ids,"onUpdate:modelValue":l[10]||(l[10]=s=>e.form.referral_ids=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.referral_ids?(a(),y(f,{key:0},{default:t(()=>[i(c(e.form.errors.referral_ids),1)]),_:1})):d("",!0)]),_:1})]),_:1})]),n("div",X,[r(O,{color:"primary",dark:"",type:"submit"},{default:t(()=>[i("Create Case")]),_:1})])])]}),_:1},8,["onSubmit"])}const Z=j(J,[["render",Y]]),$={name:"CreateCase",layout:B,components:{CaseCreateForm:Z},props:{attorneys:{type:Object,required:!0,default:()=>({data:[]})},doctors:{type:Object,required:!0,default:()=>({data:[]})},patients:{type:Object,required:!0,default:()=>({data:[]})},states:{type:Object,required:!0,default:()=>({data:[]})},allCptCodes:{type:Object,required:!0,default:()=>({data:[]})},referrals:{type:Object,required:!0,default:()=>({data:[]})},userRole:{type:String,required:!0,default:""},userId:{type:Number,required:!0,default:0,validator:o=>o!==null},listRoute:{type:String,default:"panel.user.cases.index"},storeRoute:{type:String,default:"panel.user.cases.store"},error:{type:String,default:null}},computed:{formattedAttorneys(){return{data:Array.isArray(this.attorneys.data)?this.attorneys.data:[]}},formattedDoctors(){return{data:Array.isArray(this.doctors.data)?this.doctors.data:[]}},formattedPatients(){return{data:Array.isArray(this.patients.data)?this.patients.data:[]}},formattedStates(){return{data:Array.isArray(this.states.data)?this.states.data:[]}},formattedCptCodes(){return{data:Array.isArray(this.allCptCodes.data)?this.allCptCodes.data:[]}},formattedReferrals(){return{data:Array.isArray(this.referrals.data)?this.referrals.data:[]}}}},ee={class:"h-full space-y-6"},re={class:"bg-dark shadow-sm rounded-lg p-6 pb-8"},te=n("div",{class:"flex items-center gap-2"},[n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-primary-500"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})]),n("span",{class:"text-primary-500"},"Create Case")],-1),oe={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert"},le={class:"block sm:inline"},se={class:"bg-white shadow-sm rounded-lg p-6"};function ie(o,l,_,D,e,u){const m=p("v-inertia-head"),h=p("v-section-heading"),f=p("case-create-form");return a(),g(R,null,[r(m,{title:"Create Case"}),n("div",ee,[n("div",re,[r(h,null,{title:t(()=>[te]),description:t(()=>[i(" Create a new case and manage its details ")]),_:1})]),_.error?(a(),g("div",oe,[n("span",le,c(_.error),1)])):d("",!0),n("div",se,[r(f,{attorneys:u.formattedAttorneys,doctors:u.formattedDoctors,patients:u.formattedPatients,states:u.formattedStates,"all-cpt-codes":u.formattedCptCodes,referrals:u.formattedReferrals,"user-role":_.userRole,"user-id":_.userId,"list-route":_.listRoute,"store-route":_.storeRoute},null,8,["attorneys","doctors","patients","states","all-cpt-codes","referrals","user-role","user-id","list-route","store-route"])])])],64)}const ce=j($,[["render",ie]]);export{ce as default};

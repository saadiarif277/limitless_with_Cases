import{R as B,a as I,b as A}from"./_referral-patient-form-D83R-Jm0.js";import{T as H,r as m,o as d,e as y,w as e,g as s,a as r,b as a,t as o,f as h,c as f,F as v,i as C,d as V}from"./app-D0YmfmiQ.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={name:"ReferralsCreateForm",components:{"x-referral-attorney-form":B,"x-referral-doctor-form":I,"x-referral-patient-form":A},props:{allowSourceEdit:{type:Boolean,required:!1,default:()=>!0},attorneys:{type:Object,required:!0,default:()=>{}},doctors:{type:Object,required:!0,default:()=>{}},documentCategories:{type:Object,required:!1,default:()=>{}},medicalSpecialties:{type:Object,required:!0,default:()=>{}},patients:{type:Object,required:!0,default:()=>{}},referral:{type:Object,required:!0,default:()=>{}},referralReasons:{type:Object,required:!1,default:()=>{}},referralStatuses:{type:Object,required:!1,default:()=>{}},sources:{type:Object,required:!1,default:()=>{}},states:{type:Object,required:!1,default:()=>{}},listRoute:{type:String,required:!1,default:()=>"panel.admin.referrals.index"},updateRoute:{type:String,required:!1,default:()=>"panel.admin.referrals.update"},destroyDocumentRoute:{type:String,required:!1,default:()=>"panel.admin.documents.destroy"},userRole:{type:String,required:!1,default:()=>null}},data(){return{formDocuments:{},form:H({_method:"patch",referral_date:"",referral_status_id:"",state_id:"",source_user_id:this.$page.props.auth.user.user_id,documents:{}})}},computed:{currentUserRole(){if(this.userRole)return this.userRole;const i=this.$page.props.auth.roles||[];return i.length>0?i[0]:"Unknown"}},watch:{referral:{handler(i){!i||!i.data||(this.form.referral_date=i.data.referral_date,this.form.referral_status_id=i.data.referral_status_id,this.form.state_id=i.data.state_id,this.form.documents={},this.populateFormDocuments())},immediate:!0,deep:!0}},methods:{populateFormDocuments(){if(!this.referral.data||!this.referral.data.documents)return;const i={};Object.keys(this.referral.data.documents).forEach(c=>{const t=JSON.parse(JSON.stringify(this.referral.data.documents[c]));i[t.document_type_id]=t,this.form.documents[t.document_type_id]=""}),this.formDocuments=i},submitForm(){this.form.clearErrors(),Object.keys(this.form.documents).forEach(i=>{this.form.documents[i]||(this.form.documents[i]=void 0)}),this.form.post(this.route(this.updateRoute,{referral:this.referral.data.referral_id}),{onSuccess:()=>{this.$toast().success("Referral updated successfully!"),this.$inertia.reload()},onError:i=>{Object.keys(i).forEach(c=>{const t=i[c];this.$toast().error(t)})}})},destroyDocument(i,c){this.form.delete(this.route(this.destroyDocumentRoute,{document:i}),{onSuccess:()=>{this.$toast().success("Document deleted successfully!"),this.$inertia.reload()},onError:t=>{Object.keys(t).forEach(b=>{const l=t[b];this.$toast().error(l)})}})},canViewDocumentType(i){var b;if(this.currentUserRole==="Administrator")return!0;const c=(b=this.documentCategories.data)==null?void 0:b.find(l=>l.document_category_id===i.document_category_id),t=c==null?void 0:c.name;return this.currentUserRole==="Doctor"?t==="Medical Documents":this.currentUserRole==="Attorney"||this.currentUserRole==="Case_manager"?t==="Financial Documents":!0},canUploadDocumentType(i){var b;if(this.currentUserRole==="Administrator")return!0;const c=(b=this.documentCategories.data)==null?void 0:b.find(l=>l.document_category_id===i.document_category_id),t=c==null?void 0:c.name;return this.currentUserRole==="Doctor"?t==="Medical Documents":this.currentUserRole==="Attorney"||this.currentUserRole==="Case_manager"?t==="Financial Documents":!1}}},L={class:"h-full divide-y divide-gray-200 space-y-12"},Y={class:"divide-y divide-gray-200"},G=s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Doctor"),a(" Information ")],-1),K={key:0,class:"italic"},Q={key:1,class:"italic"},W={class:"flex items-center gap-2 italic"},X=s("div",{class:"w-1 h-1 rounded-full bg-gray-500"},null,-1),Z=s("div",null," ",-1),T={class:"flex items-center gap-2 italic"},$=s("div",{class:"w-1 h-1 rounded-full bg-gray-500"},null,-1),ee={class:"divide-y divide-gray-200"},te=s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Patient"),a(" Information ")],-1),re={class:"flex items-center gap-2 italic"},se=s("div",{class:"w-1 h-1 rounded-full bg-gray-500"},null,-1),ae={class:"flex flex-col gap-2"},le={class:"flex items-center gap-2"},oe={class:"divide-y divide-gray-200"},ie=s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Attorney"),a(" Information ")],-1),de={class:"flex items-center gap-2 italic"},ne=s("div",{class:"w-1 h-1 rounded-full bg-gray-500"},null,-1),ue=s("div",null," ",-1),ce={class:"flex items-center gap-2 italic"},_e=s("div",{class:"w-1 h-1 rounded-full bg-gray-500"},null,-1),fe={class:"divide-y divide-gray-200"},me={class:"flex items-center gap-2"},he=s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})],-1),ye=s("span",{class:"text-primary-500"},"Document",-1),ge={class:"text-sm text-gray-500"},pe={class:"grid grid-cols-1 gap-4"},ve={key:0,class:"space-y-1"},be={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},we=["onClick"],xe=s("span",{class:"text-red-500 uppercase"}," Delete ",-1),ke=[xe],De={class:"py-2"},Re=["href"],je=s("div",{class:"max-w-full overflow-hidden line-clamp-1"}," Download ",-1),Ue=[je],Ve={key:1,class:"w-full text-center inline-flex items-center justify-center border rounded-md shadow-sm focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed px-4 py-2.5 text-sm font-medium border-gray-200 text-gray-500 bg-white opacity-50 cursor-not-allowed",href:"#",target:"_blank"},Se=s("div",{class:"max-w-full overflow-hidden line-clamp-1"}," No File ",-1),Ce=[Se],qe={key:1,class:"text-gray-500 italic"},Oe=s("span",{class:"text-red-500 uppercase"}," Cancel ",-1),Fe={class:"overflow-hidden"},Me=["value"];function Ee(i,c,t,b,l,g){const k=m("v-form-label"),q=m("v-form-input"),R=m("v-form-error"),w=m("v-form-group"),j=m("v-form-select"),p=m("v-content-body"),D=m("v-section-heading"),x=m("v-heading"),_=m("v-paragraph"),O=m("v-link"),F=m("v-form-file"),M=m("v-card"),S=m("v-button"),E=m("v-form");return d(),y(E,{class:"h-full",onSubmit:V(g.submitForm,["prevent"])},{default:e(()=>[s("div",L,[s("div",null,[r(p,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:e(()=>[r(w,null,{default:e(()=>[r(k,null,{default:e(()=>[a("Referral Date")]),_:1}),r(q,{type:"date",modelValue:l.form.referral_date,"onUpdate:modelValue":c[0]||(c[0]=u=>l.form.referral_date=u),error:l.form.errors.referral_date,disabled:l.form.processing},null,8,["modelValue","error","disabled"]),l.form.errors.referral_date?(d(),y(R,{key:0},{default:e(()=>[a(o(l.form.errors.referral_date),1)]),_:1})):h("",!0)]),_:1}),r(w,null,{default:e(()=>[r(k,null,{default:e(()=>[a("Referral Status")]),_:1}),r(j,{options:t.referralStatuses.data.map(u=>({label:u.name,value:u.referral_status_id})),error:l.form.errors.referral_status_id,disabled:l.form.processing,required:!0,modelValue:l.form.referral_status_id,"onUpdate:modelValue":c[1]||(c[1]=u=>l.form.referral_status_id=u)},null,8,["options","error","disabled","modelValue"]),l.form.errors.referral_status_id?(d(),y(R,{key:0},{default:e(()=>[a(o(l.form.errors.referral_status_id),1)]),_:1})):h("",!0)]),_:1}),r(w,null,{default:e(()=>[r(k,null,{default:e(()=>[a("Referral State")]),_:1}),r(j,{options:t.states.data.map(u=>({label:u.name,value:u.state_id})),error:l.form.errors.state_id,disabled:!0,required:!0,modelValue:l.form.state_id,"onUpdate:modelValue":c[2]||(c[2]=u=>l.form.state_id=u)},null,8,["options","error","modelValue"]),l.form.errors.state_id?(d(),y(R,{key:0},{default:e(()=>[a(o(l.form.errors.state_id),1)]),_:1})):h("",!0)]),_:1}),t.allowSourceEdit?(d(),y(w,{key:0},{default:e(()=>[r(k,null,{default:e(()=>[a("Referral Source")]),_:1}),r(j,{options:[{label:i.$page.props.auth.user.name,value:i.$page.props.auth.user.user_id},...t.sources.data.map(u=>({label:u.name,value:u.user_id}))],error:l.form.errors.source_user_id,disabled:l.form.processing,modelValue:l.form.source_user_id,"onUpdate:modelValue":c[3]||(c[3]=u=>l.form.source_user_id=u)},null,8,["options","error","disabled","modelValue"]),l.form.errors.source_user_id?(d(),y(R,{key:0},{default:e(()=>[a(o(l.form.errors.source_user_id),1)]),_:1})):h("",!0)]),_:1})):h("",!0)]),_:1})]),s("div",Y,[r(p,{class:""},{default:e(()=>[r(D,null,{title:e(()=>[G]),_:1})]),_:1}),r(p,{class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-4"},{default:e(()=>[s("div",null,[r(x,{size:6,class:"font-medium"},{default:e(()=>[a(o(t.referral.data.doctor_user.name)+" ",1),t.referral.data.doctor_user.medical_specialty?(d(),f("span",K,"("+o(t.referral.data.doctor_user.medical_specialty.name)+")",1)):(d(),f("span",Q,"(No Medical Specialty)"))]),_:1}),s("div",W,[r(_,null,{default:e(()=>[a(o(t.referral.data.doctor_user.email),1)]),_:1}),X,r(_,null,{default:e(()=>[a(o(t.referral.data.doctor_user.phone_number),1)]),_:1})]),Z]),s("div",null,[r(x,{size:6,class:"font-medium"},{default:e(()=>[a(o(t.referral.data.clinic.name),1)]),_:1}),s("div",T,[r(_,null,{default:e(()=>[a(o(t.referral.data.clinic.email),1)]),_:1}),$,r(_,null,{default:e(()=>[a(o(t.referral.data.clinic.phone_number),1)]),_:1})]),r(_,{class:"italic"},{default:e(()=>[a(o(t.referral.data.clinic.address_line_1)+", ",1),t.referral.data.clinic.address_line_2?(d(),f(v,{key:0},[a(o(t.referral.data.clinic.address_line_2)+",",1)],64)):h("",!0),a(" "+o(t.referral.data.clinic.city)+", "+o(t.referral.data.clinic.state.name)+", "+o(t.referral.data.clinic.zip_code),1)]),_:1})])]),_:1})]),s("div",ee,[r(p,{class:""},{default:e(()=>[r(D,null,{title:e(()=>[te]),_:1})]),_:1}),r(p,{class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-4"},{default:e(()=>[s("div",null,[r(x,{size:6,class:"font-medium"},{default:e(()=>[a(o(t.referral.data.patient_user.name),1)]),_:1}),s("div",re,[r(_,null,{default:e(()=>[a(o(t.referral.data.patient_user.email),1)]),_:1}),se,r(_,null,{default:e(()=>[a(o(t.referral.data.patient_user.phone_number),1)]),_:1})]),r(_,{class:"italic"},{default:e(()=>[a(o(t.referral.data.patient_user.address_line_1)+", ",1),t.referral.data.patient_user.address_line_2?(d(),f(v,{key:0},[a(o(t.referral.data.patient_user.address_line_2)+",",1)],64)):h("",!0),a(" "+o(t.referral.data.patient_user.city)+", "+o(t.referral.data.patient_user.state.name)+", "+o(t.referral.data.patient_user.zip_code),1)]),_:1})]),s("div",ae,[s("div",null,[r(x,{size:6},{default:e(()=>[a("Injury Date")]),_:1}),r(_,{class:"italic"},{default:e(()=>[a(o(t.referral.data.injury_date||"Missing Injury Date"),1)]),_:1})]),s("div",null,[r(x,{size:6,class:"font-medium"},{default:e(()=>[a("Referral Reasons")]),_:1}),s("div",le,[r(_,{class:"italic"},{default:e(()=>[a(o(t.referral.data.referral_reasons.map(u=>u.name)),1)]),_:1})])])])]),_:1})]),s("div",oe,[r(p,{class:""},{default:e(()=>[r(D,null,{title:e(()=>[ie]),_:1})]),_:1}),r(p,{class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-4"},{default:e(()=>[s("div",null,[r(x,{size:6,class:"font-medium"},{default:e(()=>[a(o(t.referral.data.attorney_user.name),1)]),_:1}),s("div",de,[r(_,null,{default:e(()=>[a(o(t.referral.data.attorney_user.email),1)]),_:1}),ne,r(_,null,{default:e(()=>[a(o(t.referral.data.attorney_user.phone_number),1)]),_:1})]),ue]),s("div",null,[r(x,{size:6,class:"font-medium"},{default:e(()=>[a(o(t.referral.data.attorney_user.law_firm.name),1)]),_:1}),s("div",ce,[r(_,null,{default:e(()=>[a(o(t.referral.data.attorney_user.law_firm.email),1)]),_:1}),_e,r(_,null,{default:e(()=>[a(o(t.referral.data.attorney_user.law_firm.phone_number),1)]),_:1})]),r(_,{class:"italic"},{default:e(()=>[a(o(t.referral.data.attorney_user.law_firm.address_line_1)+", ",1),t.referral.data.attorney_user.law_firm.address_line_2?(d(),f(v,{key:0},[a(o(t.referral.data.attorney_user.law_firm.address_line_2)+",",1)],64)):h("",!0),a(" "+o(t.referral.data.attorney_user.law_firm.city)+", "+o(t.referral.data.attorney_user.law_firm.state.name)+", "+o(t.referral.data.attorney_user.law_firm.zip_code),1)]),_:1})])]),_:1})]),s("div",fe,[r(p,{class:""},{default:e(()=>[r(D,null,{title:e(()=>[s("div",me,[he,ye,a(" Information "),s("span",ge,"("+o(g.currentUserRole)+")",1)])]),_:1})]),_:1}),r(p,null,{default:e(()=>[s("div",pe,[(d(!0),f(v,null,C(t.documentCategories.data,(u,z)=>(d(),f(v,{key:"documentCategory_"+z},[u.document_types&&u.document_types.length?(d(),f("div",ve,[r(D,null,{title:e(()=>[a(o(u.name),1)]),_:2},1024),s("div",be,[(d(!0),f(v,null,C(u.document_types.filter(n=>g.canViewDocumentType(n)),(n,N)=>(d(),y(M,{key:"documentType_"+N},{default:e(()=>[r(p,{class:"flex flex-col divide-y divide-gray-200"},{default:e(()=>[r(w,{class:"pb-4"},{default:e(()=>[r(k,{class:"flex items-center justify-between"},{default:e(()=>[a(o(n.name)+" ",1),l.formDocuments[n.document_type_id]&&!n.is_generated?(d(),f("a",{key:0,href:"#",onClick:V(U=>g.destroyDocument(l.formDocuments[n.document_type_id].document_id,n.document_type_id),["stop"])},ke,8,we)):h("",!0)]),_:2},1024),s("div",De,[l.formDocuments[n.document_type_id]&&l.formDocuments[n.document_type_id].document_id?(d(),f("a",{key:0,class:"w-full text-center inline-flex items-center justify-center border rounded-md shadow-sm focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed px-4 py-2.5 text-sm font-medium border-gray-200 hover:border-gray-800 text-gray-500 bg-white hover:bg-gray-800 hover:text-white",href:i.route("panel.admin.documents.download",{document:l.formDocuments[n.document_type_id].document_id,_t:Date.now()}),target:"_blank"},Ue,8,Re)):(d(),f("a",Ve,Ce))])]),_:2},1024),n.is_generated?(d(),y(w,{key:1,class:"pt-4"},{default:e(()=>[r(_,{class:"italic"},{default:e(()=>[a(" System generated documents cannot be replaced or removed. ")]),_:1})]),_:1})):(d(),y(w,{key:0,class:"pt-4"},{default:e(()=>[r(k,{class:"flex items-center justify-between"},{default:e(()=>[n.is_generated?(d(),f(v,{key:0},[a(" -- ")],64)):g.canUploadDocumentType(n)?l.formDocuments[n.document_type_id]&&l.formDocuments[n.document_type_id].document_id?(d(),f(v,{key:2},[a(" Replace Document ")],64)):(d(),f(v,{key:3},[a(" Upload Document ")],64)):(d(),f("span",qe,"Upload Restricted for "+o(g.currentUserRole),1)),l.form.documents[n.document_type_id]&&g.canUploadDocumentType(n)?(d(),y(O,{key:4,href:"#",onClick:V(U=>l.form.documents[n.document_type_id]=void 0,["stop"])},{default:e(()=>[Oe]),_:2},1032,["onClick"])):h("",!0)]),_:2},1024),s("div",Fe,[r(F,{modelValue:l.form.documents[n.document_type_id],"onUpdate:modelValue":U=>l.form.documents[n.document_type_id]=U,disabled:l.form.processing||n.is_generated||!g.canUploadDocumentType(n)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),!g.canUploadDocumentType(n)&&!n.is_generated?(d(),y(_,{key:0,class:"text-sm text-gray-500 italic mt-2"},{default:e(()=>[a(" You don't have permission to upload this document type as a "+o(g.currentUserRole)+". ",1)]),_:1})):h("",!0)]),_:2},1024))]),_:2},1024)]),_:2},1024))),128))])])):h("",!0)],64))),128))])]),_:1})]),r(w,{class:"col-span-full flex items-center justify-end gap-2 text-right border-t border-gray-200 bg-gray-50 px-6 py-4"},{default:e(()=>[l.form.progress?(d(),f("progress",{key:0,value:l.form.progress.percentage,max:"100"},o(l.form.progress.percentage)+"% ",9,Me)):h("",!0),r(S,{href:i.route(this.listRoute),color:"white",disabled:l.form.processing},{default:e(()=>[a(" Cancel ")]),_:1},8,["href","disabled"]),r(S,{disabled:l.form.processing},{default:e(()=>[a(" Save Changes ")]),_:1},8,["disabled"])]),_:1})])]),_:1},8,["onSubmit"])}const Ie=J(P,[["render",Ee]]);export{Ie as R};

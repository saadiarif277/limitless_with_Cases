import{L}from"./index-BkP0jPDe.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as _,o as m,c as f,a as t,g as s,w as l,F as C,b as o,t as i,i as V,e as A,f as b,n as N,p as z,j as E}from"./app-Bi_K_mTy.js";import"./_user-menu-BSju8n0v.js";const H={layout:L,props:{caseDetails:{type:Object,required:!0},icdCodeDescription:{type:String,required:!0},cptCodeDescriptions:{type:Array,required:!0},referrals:{type:Array,required:!0},allCptCodes:Array},data(){return{billingType:this.caseDetails.billing_type||"LOP",cptCodes:[],isModalOpen:!1,reductionAmount:null,reductionFile:null,isFormValid:!0,selectedReferralId:null,form:this.$inertia.form({cptCodes:[]})}},methods:{downloadCMS1500Form(){},markReferralComplete(n){this.$toast().success(`Referral #${n} marked as complete!`)},markReferralLost(n){this.$toast().info(`Referral #${n} marked as lost.`)},openReductionModal(n){this.selectedReferralId=n,this.isModalOpen=!0},closeReductionModal(){this.isModalOpen=!1,this.reductionAmount=null,this.reductionFile=null,this.selectedReferralId=null},async submitReduction(){if(this.isFormValid&&this.selectedReferralId){const n=new FormData;n.append("case_id",this.caseDetails.case_id),n.append("referral_id",this.selectedReferralId),n.append("amount",this.reductionAmount),n.append("referral_status","reduction_request_sent"),this.reductionFile&&n.append("file",this.reductionFile);try{const a=await axios.post("/reduction-requests",n,{headers:{"Content-Type":"multipart/form-data"}});this.$toast().info("Reduction request sent successfully."),this.closeReductionModal(),this.$inertia.reload()}catch(a){this.$toast().error("Error sending reduction request."),console.error("Error:",a.response.data)}}},formatDate(n){if(!n)return"N/A";const a=new Date(n);return isNaN(a)?"Invalid Date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(a)},getStatusBadgeClass(n){switch(n){case"pending":return"bg-yellow-500 text-white px-2 py-1 rounded text-sm";case"reduction_request_sent":return"bg-blue-500 text-white px-2 py-1 rounded text-sm";case"accepted":return"bg-green-500 text-white px-2 py-1 rounded text-sm";case"rejected":return"bg-red-500 text-white px-2 py-1 rounded text-sm";default:return"bg-gray-500 text-white px-2 py-1 rounded text-sm"}},getStatusText(n){switch(n){case"pending":return"Pending";case"reduction_request_sent":return"Reduction Request Sent";case"accepted":return"Accepted";case"rejected":return"Rejected";default:return"Unknown"}},getDoctorDecisionBadgeClass(n){switch(n){case"pending":return"bg-yellow-500 text-white px-2 py-1 mb-2 rounded text-sm";case"accepted":return"bg-green-500 text-white px-2 py-1  mb-2  rounded text-sm";case"rejected":return"bg-red-500 text-white px-2 py-1  mb-2  rounded text-sm";default:return"bg-gray-500 text-white px-2 py-1  mb-2  rounded text-sm"}},getDoctorDecisionText(n){switch(n){case"pending":return"Pending";case"accepted":return"Accepted";case"rejected":return"Rejected";default:return"Unknown"}},addCptCode(){this.form.cptCodes.push({code:null,value:0})},removeCptCode(n){this.form.cptCodes.splice(n,1)},async saveCase(){const n={billing_type:this.billingType,cpt_codes:JSON.stringify(this.form.cptCodes),is_cms1500_generated:this.billingType==="LOP"?1:0};try{const a=await axios.post(route("panel.admin.newcase.updateBilling",{case:this.caseDetails.case_id}),n,{headers:{"Content-Type":"application/json"}});this.$toast().success("Billing information updated successfully."),this.$inertia.reload()}catch(a){this.$toast().error("Error updating billing information."),console.error("Error:",a.response?a.response.data:a.message)}}}},g=n=>(z("data-v-9a29f8ce"),n=n(),E(),n),J={class:"h-full space-y-6"},Y={class:"bg-white shadow-sm rounded-lg p-6"},G=g(()=>s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Patient"),o(" Information ")],-1)),K={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4"},Q={class:"flex flex-col gap-1"},W={class:"bg-white shadow-sm rounded-lg p-6"},X=g(()=>s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Attorney"),o(" Information ")],-1)),Z={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4"},$={class:"flex flex-col gap-1"},ee={class:"bg-white shadow-sm rounded-lg p-6"},te=g(()=>s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Billing"),o(" Information ")],-1)),le={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4"},se={class:"flex flex-col gap-1"},oe={key:0},ne={class:"list-disc pl-5"},ie={class:"mt-4"},ae={key:0,class:"mt-4"},re={key:0,class:"text-gray-500 mb-4"},de={class:"mt-6"},ce={class:"bg-white shadow-sm rounded-lg p-6"},ue=g(()=>s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Policy Limit"),o(" Information ")],-1)),_e={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4"},me={class:"flex flex-col gap-1"},pe={class:"bg-white shadow-sm rounded-lg p-6"},fe=g(()=>s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"Referrals")],-1)),ge={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4"},he={class:"flex flex-col gap-2"},ve={key:1,class:"text-gray-500"},ye={key:0,class:"mt-4"},xe=["href"],we={class:"flex gap-2 mt-2"},Ce={class:"bg-white shadow-sm rounded-lg p-6"},be=g(()=>s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 text-primary-500"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})]),s("span",{class:"text-primary-500"},"CMS 1500 Form")],-1)),ke={class:"mt-4"},De=g(()=>s("span",{class:"headline"},"Send for Reduction",-1)),Ve=g(()=>s("span",{class:"text-dark-500 italic"},"Amount for Reduction",-1)),Ae=g(()=>s("span",{class:"text-dark-500 italic"},"Upload Supporting File",-1));function Me(n,a,u,Ne,r,p){const B=_("v-inertia-head"),y=_("v-section-heading"),x=_("v-heading"),c=_("v-paragraph"),w=_("v-content-body"),k=_("v-form-label"),I=_("v-form-select"),D=_("v-form-group"),M=_("v-form-input"),v=_("v-button"),F=_("v-link"),T=_("v-card-title"),S=_("v-form"),P=_("v-card-text"),R=_("v-btn"),j=_("v-card-actions"),U=_("v-card"),q=_("v-dialog");return m(),f(C,null,[t(B,{title:"Case Details"}),s("div",J,[s("div",Y,[t(w,null,{default:l(()=>[t(y,null,{title:l(()=>[G]),_:1}),s("div",K,[s("div",null,[t(x,{size:6,class:"font-medium"},{default:l(()=>{var e;return[o(i(((e=u.caseDetails.patient)==null?void 0:e.name)||"N/A"),1)]}),_:1})]),s("div",Q,[t(c,null,{default:l(()=>{var e;return[o("Email: "+i(((e=u.caseDetails.patient)==null?void 0:e.email)||"N/A"),1)]}),_:1}),t(c,null,{default:l(()=>{var e,d;return[o("Address: "+i(((e=u.caseDetails.patient)==null?void 0:e.address_line_1)||"N/A")+", "+i(((d=u.caseDetails.patient)==null?void 0:d.address_line_2)||"N/A"),1)]}),_:1})])])]),_:1})]),s("div",W,[t(w,null,{default:l(()=>[t(y,null,{title:l(()=>[X]),_:1}),s("div",Z,[s("div",null,[t(x,{size:6,class:"font-medium"},{default:l(()=>{var e;return[o(i(((e=u.caseDetails.attorney)==null?void 0:e.name)||"N/A"),1)]}),_:1})]),s("div",$,[t(c,null,{default:l(()=>{var e;return[o("Email: "+i(((e=u.caseDetails.attorney)==null?void 0:e.email)||"N/A"),1)]}),_:1})])])]),_:1})]),s("div",ee,[t(w,null,{default:l(()=>[t(y,null,{title:l(()=>[te]),_:1}),s("div",le,[s("div",null,[t(x,{size:6,class:"font-medium"},{default:l(()=>[o("Billing Details")]),_:1})]),s("div",se,[t(c,null,{default:l(()=>[o("Billing Type: "+i(u.caseDetails.billing_type||"N/A"),1)]),_:1}),t(c,null,{default:l(()=>[o("ICD-10 Code: "+i(u.icdCodeDescription||"N/A"),1)]),_:1}),t(c,null,{default:l(()=>[o("Service Billed: "+i(u.caseDetails.service_billed||"N/A"),1)]),_:1}),u.cptCodeDescriptions.length?(m(),f("div",oe,[t(c,null,{default:l(()=>[o("CPT Codes:")]),_:1}),s("ul",ne,[(m(!0),f(C,null,V(u.cptCodeDescriptions,e=>(m(),f("li",{key:e},i(e),1))),128))])])):(m(),A(c,{key:1},{default:l(()=>[o("CPT Codes: N/A")]),_:1}))])]),s("div",ie,[t(D,null,{default:l(()=>[t(k,null,{default:l(()=>[o("Billing Type")]),_:1}),t(I,{modelValue:r.billingType,"onUpdate:modelValue":a[0]||(a[0]=e=>r.billingType=e),options:[{label:"LOP",value:"LOP"},{label:"Insurance",value:"Insurance"}],error:r.form.errors.billing_type,disabled:r.form.processing,class:"w-full"},null,8,["modelValue","error","disabled"])]),_:1})]),r.billingType==="Insurance"?(m(),f("div",ae,[t(D,null,{default:l(()=>[t(k,{class:"mb-2"},{default:l(()=>[o("CPT Codes")]),_:1}),r.form.cptCodes.length===0?(m(),f("div",re," No CPT codes added yet. ")):b("",!0),(m(!0),f(C,null,V(r.form.cptCodes,(e,d)=>(m(),f("div",{key:d,class:"flex gap-2 mb-2"},[t(I,{options:u.allCptCodes.map(h=>({label:`${h.code} - ${h.description}`,value:h.id})),modelValue:e.code,"onUpdate:modelValue":h=>e.code=h,error:r.form.errors[`cptCodes.${d}.code`],disabled:r.form.processing,class:"flex-1"},null,8,["options","modelValue","onUpdate:modelValue","error","disabled"]),t(M,{type:"number",modelValue:e.value,"onUpdate:modelValue":h=>e.value=h,error:r.form.errors[`cptCodes.${d}.value`],disabled:r.form.processing,placeholder:"Value",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue","error","disabled"]),t(v,{onClick:h=>p.removeCptCode(d),color:"red",class:"self-end"},{default:l(()=>[o(" Remove ")]),_:2},1032,["onClick"])]))),128)),t(v,{onClick:p.addCptCode,color:"primary",class:"mt-4"},{default:l(()=>[o(" Add CPT Code ")]),_:1},8,["onClick"])]),_:1})])):b("",!0),s("div",de,[t(v,{onClick:p.saveCase,color:"primary",disabled:r.form.processing,class:"w-full sm:w-auto"},{default:l(()=>[o(" Save Billing Information ")]),_:1},8,["onClick","disabled"])])]),_:1})]),s("div",ce,[t(w,null,{default:l(()=>[t(y,null,{title:l(()=>[ue]),_:1}),s("div",_e,[s("div",null,[t(x,{size:6,class:"font-medium"},{default:l(()=>[o("Policy Details")]),_:1})]),s("div",me,[t(c,null,{default:l(()=>{var e;return[o("Policy Limit: "+i(((e=u.caseDetails.policy_limit_info)==null?void 0:e.policy_limit)||"N/A"),1)]}),_:1}),t(c,null,{default:l(()=>{var e;return[o("PIP: "+i(((e=u.caseDetails.policy_limit_info)==null?void 0:e.pip)||"N/A"),1)]}),_:1}),t(c,null,{default:l(()=>{var e;return[o("Defendant Insurance: "+i(((e=u.caseDetails.policy_limit_info)==null?void 0:e.defendant_insurance)||"N/A"),1)]}),_:1}),t(c,null,{default:l(()=>{var e;return[o("Plaintiff Insurance: "+i(((e=u.caseDetails.policy_limit_info)==null?void 0:e.plaintiff_insurance)||"N/A"),1)]}),_:1}),t(c,null,{default:l(()=>{var e;return[o("Commercial Case: "+i((e=u.caseDetails.policy_limit_info)!=null&&e.commercial_case?"Yes":"No"),1)]}),_:1}),t(c,null,{default:l(()=>{var e;return[o("Type of Accident: "+i(((e=u.caseDetails.policy_limit_info)==null?void 0:e.type_of_accident)||"N/A"),1)]}),_:1})])])]),_:1})]),s("div",pe,[t(w,null,{default:l(()=>[t(y,null,{title:l(()=>[fe]),_:1}),s("div",ge,[(m(!0),f(C,null,V(u.referrals,e=>(m(),f("div",{key:e.referral_id,class:"bg-gray-50 p-4 rounded-lg shadow-sm"},[s("div",he,[t(x,{size:6,class:"font-medium"},{default:l(()=>[e.referral_id?(m(),A(F,{key:0,href:n.route("panel.admin.referrals.show",{referral:e.referral_id}),class:"text-primary-500 hover:underline"},{default:l(()=>[o(" Referral #"+i(e.referral_id),1)]),_:2},1032,["href"])):(m(),f("span",ve,"Referral ID Missing"))]),_:2},1024),t(c,null,{default:l(()=>[o("Created: "+i(p.formatDate(e.created_at)||"N/A"),1)]),_:2},1024),e.reduction_requests&&e.reduction_requests.length>0?(m(),f("div",ye,[t(x,{size:6,class:"font-medium"},{default:l(()=>[o("Reduction Requests")]),_:1}),(m(!0),f(C,null,V(e.reduction_requests,d=>(m(),f("div",{key:d.id,class:"mt-2"},[t(c,null,{default:l(()=>[o("Amount: $"+i(d.amount),1)]),_:2},1024),t(c,{class:"mt-2"},{default:l(()=>[o(" Status: "),s("span",{class:N(p.getStatusBadgeClass(d.referral_status))},i(p.getStatusText(d.referral_status)),3)]),_:2},1024),t(c,{class:"mt-4"},{default:l(()=>[o(" Doctor Decision: "),s("span",{class:N(p.getDoctorDecisionBadgeClass(d.doctor_decision))},i(p.getDoctorDecisionText(d.doctor_decision)),3)]),_:2},1024),d.counter_offer?(m(),A(c,{key:0},{default:l(()=>[o(" Counter Offer: $"+i(d.counter_offer),1)]),_:2},1024)):b("",!0),d.file_path?(m(),A(c,{key:1},{default:l(()=>[s("a",{href:d.file_link,target:"_blank",class:"text-primary-500 hover:underline"},"Download File",8,xe)]),_:2},1024)):b("",!0)]))),128))])):b("",!0),s("div",we,[t(v,{onClick:d=>p.markReferralComplete(e.referral_id),class:"bg-green-500 text-white flex-1"},{default:l(()=>[o(" Complete ")]),_:2},1032,["onClick"]),t(v,{onClick:d=>p.openReductionModal(e.referral_id),disabled:e.reduction_requests&&e.reduction_requests.length>0,class:N(["bg-orange-500 text-white flex-1",{"opacity-50 cursor-not-allowed":e.reduction_requests&&e.reduction_requests.length>0}])},{default:l(()=>[o(" Reduction ")]),_:2},1032,["onClick","disabled","class"]),t(v,{onClick:d=>p.markReferralLost(e.referral_id),class:"bg-red-500 text-white flex-1"},{default:l(()=>[o(" Lost ")]),_:2},1032,["onClick"])])])]))),128))])]),_:1})]),s("div",Ce,[t(w,null,{default:l(()=>[t(y,null,{title:l(()=>[be]),_:1}),s("div",ke,[t(v,{onClick:p.downloadCMS1500Form,color:"primary"},{default:l(()=>[o(" Download CMS 1500 Form ")]),_:1},8,["onClick"])])]),_:1})])]),t(q,{modelValue:r.isModalOpen,"onUpdate:modelValue":a[4]||(a[4]=e=>r.isModalOpen=e),persistent:"","max-width":"500px"},{default:l(()=>[t(U,null,{default:l(()=>[t(T,null,{default:l(()=>[De]),_:1}),t(P,null,{default:l(()=>[t(S,{modelValue:r.isFormValid,"onUpdate:modelValue":a[3]||(a[3]=e=>r.isFormValid=e),ref:"reductionForm"},{default:l(()=>[t(D,{class:"col-span-full sm:col-span-2 xl:col-span-3"},{default:l(()=>[t(k,null,{default:l(()=>[Ve]),_:1}),t(M,{type:"number",modelValue:r.reductionAmount,"onUpdate:modelValue":a[1]||(a[1]=e=>r.reductionAmount=e),class:"border border-gray-300 rounded-lg",required:""},null,8,["modelValue"])]),_:1}),t(D,{class:"col-span-full sm:col-span-2 xl:col-span-3"},{default:l(()=>[t(k,null,{default:l(()=>[Ae]),_:1}),t(M,{type:"file",modelValue:r.reductionFile,"onUpdate:modelValue":a[2]||(a[2]=e=>r.reductionFile=e),class:"border border-gray-300 rounded-lg",required:""},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(j,null,{default:l(()=>[t(R,{text:"",onClick:p.closeReductionModal},{default:l(()=>[o("Cancel")]),_:1},8,["onClick"]),t(R,{color:"orange",disabled:!r.isFormValid,onClick:p.submitReduction},{default:l(()=>[o("Submit")]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Te=O(H,[["render",Me],["__scopeId","data-v-9a29f8ce"]]);export{Te as default};

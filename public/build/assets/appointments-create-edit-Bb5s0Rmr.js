import{L as A}from"./index-CUO78Va1.js";import{T as F,r as d,o as i,c as m,a as n,g as V,w as r,F as y,b as o,t as _,e as p,f,d as S}from"./app-BXgbEd8A.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_user-menu-ENtOGCbS.js";const D={name:"AppointmentsCreateEdit",layout:A,props:{appointment:{type:Object,required:!1,default:()=>{}},appointmentTypes:{type:Object,required:!1,default:()=>{}},clinics:{type:Object,required:!1,default:()=>{}},patients:{type:Object,required:!1,default:()=>{}},referral:{type:Object,required:!1,default:()=>{}}},data(){return{form:F({referral_id:"",description:"",appointment_type_id:"",clinic_id:"",patient_user_id:"",start_date:"",end_date:""})}},watch:{appointment:{handler(t){!t||!t.data||(this.form.description=t.data.description,this.form.appointment_type_id=t.data.appointment_type_id,this.form.clinic_id=t.data.clinic_id,this.form.patient_user_id=t.data.patient_user_id,this.form.start_date=t.data.start_date,this.form.end_date=t.data.end_date,t.data.referral&&(this.form.referral_id=t.data.referral.referral_id))},immediate:!0},referral:{handler(t){!t||!t.data||this.appointment||(this.form.referral_id=t.data.referral_id,this.form.clinic_id=t.data.clinic_id,this.form.patient_user_id=t.data.patient_user_id)},immediate:!0},"form.start_date":{handler(t){let l=t+"Z",s=new Date(l);s.setUTCHours(s.getUTCHours()+1);let g=s.toISOString().split(".")[0];this.form.end_date=g}}},methods:{submitForm(){this.form.clearErrors(),this.appointment&&this.appointment.data&&this.appointment.data.appointment_id?this.updateRequest():this.storeRequest()},storeRequest(){this.form.post(this.route("panel.admin.appointments.store"),{onSuccess:()=>this.$toast().success("Appointment created successfully!"),onError:t=>{Object.keys(t).forEach(l=>{const s=t[l];this.$toast().error(s)})}})},updateRequest(){this.form.patch(this.route("panel.admin.appointments.update",{appointment:this.appointment.data.appointment_id}),{onSuccess:()=>this.$toast().success("Appointment updated successfully!"),onError:t=>{Object.keys(t).forEach(l=>{const s=t[l];this.$toast().error(s)})}})},deleteRequest(){this.$alert().confirm(()=>new Promise((t,l)=>{this.form.delete(this.route("panel.admin.appointments.destroy",{appointment:this.appointment.data.appointment_id}),{onSuccess:()=>{this.$toast().success("Appointment deleted successfully!"),t()},onError:s=>{Object.keys(s).forEach(g=>{const e=s[g];this.$toast().error(e)}),l()}})}))}}},T={class:"h-full flex flex-col"},B={key:1},N={key:0,class:"flex gap-2"},I=V("span",{class:"text-red-500 font-bold"},"Error: Referral not found.",-1),P=V("br",null,null,-1),H={key:0,class:"italic"},L={key:0,class:"italic"},M=["value"];function Z(t,l,s,g,e,E){const q=d("v-inertia-head"),k=d("v-link"),b=d("v-button"),R=d("v-section-heading"),w=d("v-content-body"),j=d("v-paragraph"),u=d("v-form-label"),v=d("v-form-select"),h=d("v-form-error"),c=d("v-form-group"),C=d("v-form-input"),x=d("v-form-textarea"),O=d("v-form");return i(),m(y,null,[n(q,{title:s.appointment?`Editing '${s.appointment.data.title}' appointment.`:"Create Appointment"},null,8,["title"]),V("div",T,[n(w,{class:"border-b border-gray-200"},{default:r(()=>[n(R,null,{title:r(()=>[s.appointment?(i(),m(y,{key:1},[o(" Editing appointment. ")],64)):(i(),m(y,{key:0},[e.form.referral_id?(i(),m("span",B,[o(" for the referral "),n(k,{href:t.route("panel.admin.referrals.show",{referral:e.form.referral_id})},{default:r(()=>[o('"REF#'+_(e.form.referral_id)+'"',1)]),_:1},8,["href"])])):(i(),m(y,{key:0},[o(" Create Appointment ")],64))],64))]),description:r(()=>[s.appointment?(i(),m(y,{key:1},[o(" Change and/or modify the details for the appointment. ")],64)):(i(),m(y,{key:0},[o(" Fill up the form below to create a new appointment for the application. ")],64))]),actions:r(()=>[s.appointment?(i(),m("div",N,[e.form.referral_id?(i(),p(b,{key:0,href:t.route("panel.admin.referrals.show",{referral:e.form.referral_id}),disabled:e.form.processing,color:"white"},{default:r(()=>[o(" View Referral ")]),_:1},8,["href","disabled"])):f("",!0),n(b,{color:"danger",disabled:e.form.processing,onClick:S(E.deleteRequest,["stop"])},{default:r(()=>[o(" Delete Appointment ")]),_:1},8,["disabled","onClick"])])):f("",!0)]),_:1})]),_:1}),n(w,null,{default:r(()=>[!s.appointment&&!e.form.referral_id?(i(),p(j,{key:0},{default:r(()=>[I,o(),P,o(" Please create an appointment via a referral "),n(k,{href:t.route("panel.admin.referrals.index")},{default:r(()=>[o("here.")]),_:1},8,["href"])]),_:1})):(i(),p(O,{key:1,class:"grid grid-cols-1 sm:grid-cols-6 gap-6",onSubmit:S(E.submitForm,["prevent"])},{default:r(()=>[n(c,{class:"col-span-full sm:col-span-2"},{default:r(()=>[n(u,null,{default:r(()=>[o("Appointment Type")]),_:1}),n(v,{options:s.appointmentTypes.data.map(a=>({label:a.name,value:a.appointment_type_id})),error:e.form.errors.appointment_type_id,disabled:e.form.processing,modelValue:e.form.appointment_type_id,"onUpdate:modelValue":l[0]||(l[0]=a=>e.form.appointment_type_id=a)},null,8,["options","error","disabled","modelValue"]),e.form.errors.appointment_type_id?(i(),p(h,{key:0},{default:r(()=>[o(_(e.form.errors.appointment_type_id),1)]),_:1})):f("",!0)]),_:1}),n(c,{class:"col-span-full sm:col-span-2"},{default:r(()=>[n(u,null,{default:r(()=>[o("Start Date")]),_:1}),n(C,{type:"datetime-local",modelValue:e.form.start_date,"onUpdate:modelValue":l[1]||(l[1]=a=>e.form.start_date=a),error:e.form.errors.start_date,disabled:e.form.processing},null,8,["modelValue","error","disabled"]),e.form.errors.start_date?(i(),p(h,{key:0},{default:r(()=>[o(_(e.form.errors.start_date),1)]),_:1})):f("",!0)]),_:1}),n(c,{class:"col-span-full sm:col-span-2"},{default:r(()=>[n(u,null,{default:r(()=>[o("End Date")]),_:1}),n(C,{type:"datetime-local",modelValue:e.form.end_date,"onUpdate:modelValue":l[2]||(l[2]=a=>e.form.end_date=a),error:e.form.errors.end_date,disabled:e.form.processing},null,8,["modelValue","error","disabled"]),e.form.errors.end_date?(i(),p(h,{key:0},{default:r(()=>[o(_(e.form.errors.end_date),1)]),_:1})):f("",!0)]),_:1}),n(c,{class:"col-span-full sm:col-span-3"},{default:r(()=>[n(u,null,{default:r(()=>[o(" Clinic "),e.form.referral_id?(i(),m("span",H,[o(" (Inherited from "),n(k,{href:t.route("panel.admin.referrals.show",{referral:e.form.referral_id})},{default:r(()=>[o('"REF#'+_(e.form.referral_id)+'"',1)]),_:1},8,["href"]),o(") ")])):f("",!0)]),_:1}),n(v,{options:s.clinics.data.map(a=>({label:a.name,value:a.clinic_id})),error:e.form.errors.clinic_id,disabled:e.form.processing||!!e.form.referral_id,modelValue:e.form.clinic_id,"onUpdate:modelValue":l[3]||(l[3]=a=>e.form.clinic_id=a)},null,8,["options","error","disabled","modelValue"]),e.form.errors.clinic_id?(i(),p(h,{key:0},{default:r(()=>[o(_(e.form.errors.clinic_id),1)]),_:1})):f("",!0)]),_:1}),n(c,{class:"col-span-full sm:col-span-3"},{default:r(()=>[n(u,null,{default:r(()=>[o(" Patient "),e.form.referral_id?(i(),m("span",L,[o(" (Inherited from "),n(k,{href:t.route("panel.admin.referrals.show",{referral:e.form.referral_id})},{default:r(()=>[o('"REF#'+_(e.form.referral_id)+'"',1)]),_:1},8,["href"]),o(") ")])):f("",!0)]),_:1}),n(v,{options:s.patients.data.map(a=>({label:a.name,value:a.user_id})),error:e.form.errors.patient_user_id,disabled:e.form.processing||!!e.form.referral_id,modelValue:e.form.patient_user_id,"onUpdate:modelValue":l[4]||(l[4]=a=>e.form.patient_user_id=a)},null,8,["options","error","disabled","modelValue"]),e.form.errors.patient_user_id?(i(),p(h,{key:0},{default:r(()=>[o(_(e.form.errors.patient_user_id),1)]),_:1})):f("",!0)]),_:1}),n(c,{class:"col-span-full"},{default:r(()=>[n(u,null,{default:r(()=>[o("Description")]),_:1}),n(x,{modelValue:e.form.description,"onUpdate:modelValue":l[5]||(l[5]=a=>e.form.description=a),error:e.form.errors.description,disabled:e.form.processing},null,8,["modelValue","error","disabled"]),e.form.errors.description?(i(),p(h,{key:0},{default:r(()=>[o(_(e.form.errors.description),1)]),_:1})):f("",!0)]),_:1}),n(c,{class:"col-span-full flex items-center justify-end gap-2 text-right border-t border-gray-200 py-6"},{default:r(()=>[e.form.progress?(i(),m("progress",{key:0,value:e.form.progress.percentage,max:"100"},_(e.form.progress.percentage)+"% ",9,M)):f("",!0),n(b,{href:t.route("panel.admin.appointments.index"),color:"white",disabled:e.form.processing},{default:r(()=>[o(" Cancel ")]),_:1},8,["href","disabled"]),s.appointment?(i(),p(b,{key:2,disabled:e.form.processing},{default:r(()=>[o(" Save Changes ")]),_:1},8,["disabled"])):(i(),p(b,{key:1,disabled:e.form.processing},{default:r(()=>[o(" Create Appointment ")]),_:1},8,["disabled"]))]),_:1})]),_:1},8,["onSubmit"]))]),_:1})])],64)}const Q=U(D,[["render",Z]]);export{Q as default};

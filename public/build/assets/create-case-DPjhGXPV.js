import{L}from"./index-C99Ts5PX.js";import{T as M,r as b,o as d,e as p,w as r,g as a,c as g,t as u,f as n,a as t,b as i,F as V,i as E,d as A,l as P,q as j}from"./app-BXgbEd8A.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_user-menu-ENtOGCbS.js";const J={name:"CaseCreateForm",props:{attorneys:{type:Object,required:!0},doctors:{type:Object,required:!0},patients:{type:Object,required:!0},states:{type:Object,required:!0},allCptCodes:{type:Object,required:!0},referrals:{type:Object,required:!0},userRole:{type:String,required:!0},userId:{type:Number,required:!0},listRoute:{type:String,default:"panel.user.cases.index"},storeRoute:{type:String,default:"panel.user.cases.store"}},data(){return{form:M({state_id:0,patient_id:null,attorney_id:this.userRole==="Doctor"?null:this.userId||0,piloting_physician_id:this.userRole==="Attorney"?null:this.userId||0,policy_limit_info:JSON.stringify({policy_limit:"",pip_coverage:"",commercial_case:!1}),type_of_accident:"",billing_type:this.userRole==="Doctor"?"Insurance":null,service_billed:this.userRole==="Doctor"?"":null,cpt_codes:[],referral_ids:[],primary_referral_id:null,case_won:!1,outcome:"",reduction_accepted:!1,is_closed:!1,closed_at:null,policy_limit:this.userRole==="Attorney"?"":null,pip_coverage:this.userRole==="Attorney"?"":null,commercial_case:this.userRole==="Attorney"?!1:null,reduction_amount:(this.userRole==="Attorney",null),reduction_notes:this.userRole==="Attorney"?"":null}),selectedCptCodes:[],selectedReferrals:[]}},computed:{stateOptions(){return(this.states.data||[]).map(l=>({label:l.name,value:l.id}))},patientOptions(){return(this.patients.data||[]).map(l=>({label:l.name,value:l.user_id}))},attorneyOptions(){return(this.attorneys.data||[]).map(l=>({label:l.name,value:l.user_id}))},doctorOptions(){return(this.doctors.data||[]).map(l=>({label:l.name,value:l.user_id}))},cptCodeOptions(){var l;return(l=this.allCptCodes)!=null&&l.data?this.allCptCodes.data.map(o=>({label:`${o.code} - ${o.description}`,value:o.code,description:o.description,default_value:o.default_value})):[]},referralOptions(){return(this.referrals.data||[]).map(l=>{var o;return{label:`Referral #${l.id} - ${((o=l.patient_user)==null?void 0:o.name)||"Unknown Patient"}`,value:l.id}})}},methods:{addCptCode(){this.userRole==="Doctor"&&this.form.billing_type==="Insurance"&&this.form.cpt_codes.push({code:"",value:"",description:""})},removeCptCode(l){this.userRole==="Doctor"&&this.form.cpt_codes.splice(l,1)},updateCptCodes(){if(this.userRole==="Doctor"&&this.form.billing_type==="Insurance"){const l=this.form.cpt_codes.filter(o=>o.code&&o.value);this.form.cpt_codes=l}},submitForm(){if(this.selectedReferrals&&this.selectedReferrals.length>0&&(this.form.primary_referral_id=this.selectedReferrals[0],this.form.referral_ids=this.selectedReferrals),this.userRole==="Attorney"&&(this.form.policy_limit_info=JSON.stringify({policy_limit:this.form.policy_limit,pip_coverage:this.form.pip_coverage,commercial_case:this.form.commercial_case})),this.userRole==="Doctor")if(this.form.billing_type==="Insurance"){const l=this.form.cpt_codes.filter(o=>o.code&&o.value);this.form.cpt_codes=l}else this.form.cpt_codes=null;this.userRole==="Doctor"?(delete this.form.policy_limit,delete this.form.pip_coverage,delete this.form.commercial_case):this.userRole==="Attorney"&&(delete this.form.billing_type,delete this.form.service_billed,delete this.form.cpt_codes),this.form.post(route(this.storeRoute),{preserveScroll:!0,onSuccess:()=>{}})}},watch:{selectedCptCodes:{deep:!0,handler(){this.userRole==="Doctor"&&this.form.billing_type==="Insurance"&&this.updateCptCodes()}},selectedReferrals:{handler(l){l&&l.length>0?(this.form.primary_referral_id=l[0],this.form.referral_ids=l):(this.form.primary_referral_id=null,this.form.referral_ids=[])}},"form.billing_type":{handler(l){l==="LOP"&&(this.form.cpt_codes=[])}}}},W={class:"h-full divide-y divide-gray-200 space-y-12"},z={key:0,class:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded relative",role:"alert"},G={class:"block sm:inline"},H={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert"},K={class:"block sm:inline"},Q={key:2},X={class:"mt-6"},Y={key:0,class:"text-gray-500 mb-4"},Z={key:3},$={class:"relative"},ee=a("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[a("span",{class:"text-gray-500 sm:text-sm"},"$")],-1),re=a("p",{class:"mt-1 text-xs text-gray-500"}," Amount you're requesting to be reduced from the doctor's bill ",-1),te={class:"text-right mt-4"};function oe(l,o,_,N,e,f){const c=b("v-form-label"),h=b("v-form-select"),m=b("v-form-error"),y=b("v-form-group"),v=b("v-content-body"),C=b("v-form-input"),T=b("v-form-checkbox"),B=b("v-section-heading"),x=b("v-button"),F=b("v-form");return d(),p(F,{class:"h-full",onSubmit:A(f.submitForm,["prevent"])},{default:r(()=>{var q,w,O,S,U,D;return[a("div",W,[(O=(w=(q=l.$page)==null?void 0:q.props)==null?void 0:w.flash)!=null&&O.success?(d(),g("div",z,[a("span",G,u(l.$page.props.flash.success),1)])):n("",!0),(D=(U=(S=l.$page)==null?void 0:S.props)==null?void 0:U.flash)!=null&&D.error?(d(),g("div",H,[a("span",K,u(l.$page.props.flash.error),1)])):n("",!0),a("div",null,[t(v,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:r(()=>[t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Case State")]),_:1}),t(h,{options:_.states.data.map(s=>({label:s.name,value:s.state_id})),error:e.form.errors.state_id,disabled:e.form.processing,required:!0,modelValue:e.form.state_id,"onUpdate:modelValue":o[0]||(o[0]=s=>e.form.state_id=s)},null,8,["options","error","disabled","modelValue"]),e.form.errors.state_id?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.state_id),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Patient")]),_:1}),t(h,{options:f.patientOptions,error:e.form.errors.patient_id,disabled:e.form.processing,required:!0,modelValue:e.form.patient_id,"onUpdate:modelValue":o[1]||(o[1]=s=>e.form.patient_id=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.patient_id?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.patient_id),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Case Type")]),_:1}),t(h,{options:[{label:"Auto Accident",value:"auto_accident"},{label:"Slip and Fall",value:"slip_and_fall"},{label:"Workers Compensation",value:"workers_comp"},{label:"Personal Injury",value:"personal_injury"}],error:e.form.errors.type_of_accident,disabled:e.form.processing,required:!0,modelValue:e.form.type_of_accident,"onUpdate:modelValue":o[2]||(o[2]=s=>e.form.type_of_accident=s),class:"w-full"},null,8,["error","disabled","modelValue"]),e.form.errors.type_of_accident?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.type_of_accident),1)]),_:1})):n("",!0)]),_:1})]),_:1})]),a("div",null,[t(v,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:r(()=>[_.userRole==="Doctor"?(d(),g(V,{key:0},[t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Select Attorney")]),_:1}),t(h,{options:f.attorneyOptions,error:e.form.errors.attorney_id,disabled:e.form.processing,required:!0,modelValue:e.form.attorney_id,"onUpdate:modelValue":o[3]||(o[3]=s=>e.form.attorney_id=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.attorney_id?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.attorney_id),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Billing Type")]),_:1}),t(h,{modelValue:e.form.billing_type,"onUpdate:modelValue":o[4]||(o[4]=s=>e.form.billing_type=s),options:[{label:"Insurance",value:"Insurance"},{label:"LOP",value:"LOP"}],error:e.form.errors.billing_type,disabled:e.form.processing,required:!0,class:"w-full"},null,8,["modelValue","error","disabled"]),e.form.errors.billing_type?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.billing_type),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Service Billed")]),_:1}),t(C,{type:"number",modelValue:e.form.service_billed,"onUpdate:modelValue":o[5]||(o[5]=s=>e.form.service_billed=s),error:e.form.errors.service_billed,disabled:e.form.processing,required:!0,class:"w-full"},null,8,["modelValue","error","disabled"]),e.form.errors.service_billed?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.service_billed),1)]),_:1})):n("",!0)]),_:1})],64)):n("",!0),_.userRole==="Attorney"?(d(),g(V,{key:1},[t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Select Doctor")]),_:1}),t(h,{options:f.doctorOptions,error:e.form.errors.piloting_physician_id,disabled:e.form.processing,required:!0,modelValue:e.form.piloting_physician_id,"onUpdate:modelValue":o[6]||(o[6]=s=>e.form.piloting_physician_id=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.piloting_physician_id?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.piloting_physician_id),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Policy Limit")]),_:1}),t(C,{type:"number",error:e.form.errors.policy_limit,disabled:e.form.processing,required:!0,modelValue:e.form.policy_limit,"onUpdate:modelValue":o[7]||(o[7]=s=>e.form.policy_limit=s),class:"w-full"},null,8,["error","disabled","modelValue"]),e.form.errors.policy_limit?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.policy_limit),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("PIP Coverage")]),_:1}),t(C,{type:"number",error:e.form.errors.pip_coverage,disabled:e.form.processing,required:!0,modelValue:e.form.pip_coverage,"onUpdate:modelValue":o[8]||(o[8]=s=>e.form.pip_coverage=s),class:"w-full"},null,8,["error","disabled","modelValue"]),e.form.errors.pip_coverage?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.pip_coverage),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Commercial Case")]),_:1}),t(T,{error:e.form.errors.commercial_case,disabled:e.form.processing,modelValue:e.form.commercial_case,"onUpdate:modelValue":o[9]||(o[9]=s=>e.form.commercial_case=s)},null,8,["error","disabled","modelValue"]),e.form.errors.commercial_case?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.commercial_case),1)]),_:1})):n("",!0)]),_:1})],64)):n("",!0)]),_:1})]),_.userRole==="Doctor"&&e.form.billing_type==="Insurance"?(d(),g("div",Q,[t(v,null,{default:r(()=>[t(B,null,{title:r(()=>[i("CPT Codes")]),description:r(()=>[i("Add CPT codes for billing")]),_:1}),a("div",X,[e.form.cpt_codes.length===0?(d(),g("div",Y," No CPT codes added yet. ")):n("",!0),(d(!0),g(V,null,E(e.form.cpt_codes,(s,R)=>(d(),g("div",{key:R,class:"flex gap-4 mb-4"},[t(h,{options:f.cptCodeOptions,modelValue:s.code,"onUpdate:modelValue":k=>s.code=k,error:e.form.errors[`cpt_codes.${R}.code`],disabled:e.form.processing,class:"flex-1",placeholder:"Select CPT Code"},null,8,["options","modelValue","onUpdate:modelValue","error","disabled"]),t(C,{type:"number",modelValue:s.value,"onUpdate:modelValue":k=>s.value=k,error:e.form.errors[`cpt_codes.${R}.value`],disabled:e.form.processing,placeholder:"Value",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue","error","disabled"]),t(x,{type:"button",onClick:A(k=>f.removeCptCode(R),["prevent"]),color:"red",class:"self-end"},{default:r(()=>[i(" Remove ")]),_:2},1032,["onClick"])]))),128)),t(x,{type:"button",onClick:A(f.addCptCode,["prevent"]),color:"primary",class:"mt-4"},{default:r(()=>[i(" Add CPT Code ")]),_:1},8,["onClick"])])]),_:1})])):n("",!0),a("div",null,[t(v,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:r(()=>[t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Referrals")]),_:1}),t(h,{options:_.referrals.data.map(s=>({label:`Referral #${s.referral_id} - ${s.patient_user.name}`,value:s.referral_id})),error:e.form.errors.referral_ids,disabled:e.form.processing,multiple:!0,modelValue:e.form.referral_ids,"onUpdate:modelValue":o[10]||(o[10]=s=>e.form.referral_ids=s),class:"w-full"},null,8,["options","error","disabled","modelValue"]),e.form.errors.referral_ids?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.referral_ids),1)]),_:1})):n("",!0)]),_:1})]),_:1})]),_.userRole==="Attorney"?(d(),g("div",Z,[t(v,{class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6"},{default:r(()=>[t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Reduction Amount Requested")]),_:1}),a("div",$,[ee,P(a("input",{type:"number","onUpdate:modelValue":o[11]||(o[11]=s=>e.form.reduction_amount=s),step:"0.01",min:"0",class:"pl-7 block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"0.00"},null,512),[[j,e.form.reduction_amount]])]),re,e.form.errors.reduction_amount?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.reduction_amount),1)]),_:1})):n("",!0)]),_:1}),t(y,null,{default:r(()=>[t(c,null,{default:r(()=>[i("Reduction Notes")]),_:1}),P(a("textarea",{"onUpdate:modelValue":o[12]||(o[12]=s=>e.form.reduction_notes=s),rows:"3",class:"block w-full border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Explain why you're requesting this reduction..."},null,512),[[j,e.form.reduction_notes]]),e.form.errors.reduction_notes?(d(),p(m,{key:0},{default:r(()=>[i(u(e.form.errors.reduction_notes),1)]),_:1})):n("",!0)]),_:1})]),_:1})])):n("",!0),a("div",te,[t(x,{color:"primary",dark:"",type:"submit"},{default:r(()=>[i("Create Case")]),_:1})])])]}),_:1},8,["onSubmit"])}const le=I(J,[["render",oe]]),se={name:"CreateCase",layout:L,components:{CaseCreateForm:le},props:{attorneys:{type:Object,required:!0,default:()=>({data:[]})},doctors:{type:Object,required:!0,default:()=>({data:[]})},patients:{type:Object,required:!0,default:()=>({data:[]})},states:{type:Object,required:!0,default:()=>({data:[]})},allCptCodes:{type:Object,required:!0,default:()=>({data:[]})},referrals:{type:Object,required:!0,default:()=>({data:[]})},userRole:{type:String,required:!0,default:""},userId:{type:Number,required:!0,default:0,validator:l=>l!==null},listRoute:{type:String,default:"panel.user.cases.index"},storeRoute:{type:String,default:"panel.user.cases.store"},error:{type:String,default:null}},computed:{formattedAttorneys(){return{data:Array.isArray(this.attorneys.data)?this.attorneys.data:[]}},formattedDoctors(){return{data:Array.isArray(this.doctors.data)?this.doctors.data:[]}},formattedPatients(){return{data:Array.isArray(this.patients.data)?this.patients.data:[]}},formattedStates(){return{data:Array.isArray(this.states.data)?this.states.data:[]}},formattedCptCodes(){return{data:Array.isArray(this.allCptCodes.data)?this.allCptCodes.data:[]}},formattedReferrals(){return{data:Array.isArray(this.referrals.data)?this.referrals.data:[]}}}},ie={class:"h-full space-y-6"},de={class:"bg-dark shadow-sm rounded-lg p-6 pb-8"},ae=a("div",{class:"flex items-center gap-2"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-primary-500"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})]),a("span",{class:"text-primary-500"},"Create Case")],-1),ne={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert"},ue={class:"block sm:inline"},ce={class:"bg-white shadow-sm rounded-lg p-6"};function me(l,o,_,N,e,f){const c=b("v-inertia-head"),h=b("v-section-heading"),m=b("case-create-form");return d(),g(V,null,[t(c,{title:"Create Case"}),a("div",ie,[a("div",de,[t(h,null,{title:r(()=>[ae]),description:r(()=>[i(" Create a new case and manage its details ")]),_:1})]),_.error?(d(),g("div",ne,[a("span",ue,u(_.error),1)])):n("",!0),a("div",ce,[t(m,{attorneys:f.formattedAttorneys,doctors:f.formattedDoctors,patients:f.formattedPatients,states:f.formattedStates,"all-cpt-codes":f.formattedCptCodes,referrals:f.formattedReferrals,"user-role":_.userRole,"user-id":_.userId,"list-route":_.listRoute,"store-route":_.storeRoute},null,8,["attorneys","doctors","patients","states","all-cpt-codes","referrals","user-role","user-id","list-route","store-route"])])])],64)}const be=I(se,[["render",me]]);export{be as default};
